rewrite(|file:///home/sander/Dropbox/Afstuderen%20UvA/graphs/untitled/src/verwerkt/markitup/prepared/|, {}, {"jquery-1.6.2"});

markLijstje = [
	|file:///home/sander/Dropbox/Afstuderen%20UvA/graphs/untitled/src/verwerkt/markitup/prepared/main.js|,
	|file:///home/sander/Dropbox/Afstuderen%20UvA/graphs/untitled/src/verwerkt/markitup/prepared/markitup/sets/default/set.js|,
	|file:///home/sander/Dropbox/Afstuderen%20UvA/graphs/untitled/src/verwerkt/markitup/prepared/markitup/jquery.markitup.js|,
	|file:///home/sander/Dropbox/Afstuderen%20UvA/graphs/untitled/src/verwerkt/markitup/prepared/markitup/jquery-1.6.2.js|
];

markLijstjeNoFrameworks = [
	|file:///home/sander/Dropbox/Afstuderen%20UvA/graphs/untitled/src/verwerkt/markitup/prepared/main.js|,
	|file:///home/sander/Dropbox/Afstuderen%20UvA/graphs/untitled/src/verwerkt/markitup/prepared/markitup/sets/default/set.js|,
	|file:///home/sander/Dropbox/Afstuderen%20UvA/graphs/untitled/src/verwerkt/markitup/prepared/markitup/jquery.markitup.js|
];

tuple[Graph[Vertex] calls, set[Vertex] escaping, set[Vertex] unresolved] pesMark = readBinaryValueFile(#tuple[Graph[Vertex], set[Vertex] ,set[Vertex]], |project://JavaScript%20cg%20algorithms/src/dynamicgraph/testing/snippets/markitup/pessimistic.bin|);
Graph[Vertex] optMark = readBinaryValueFile(#Graph[Vertex], |project://JavaScript%20cg%20algorithms/src/dynamicgraph/testing/snippets/markitup/optimistic.bin|);

//pesMark2 = createCleanPessimisticCallGraph(markLijstje);
//optMark2 = createCleanOptimisticCallGraph(markLijstje);

loc callGraphIncl = |file:///home/sander/Dropbox/Afstuderen%20UvA/graphs/untitled/src/verwerkt/markitup/instrumented-incl/callmap.json|;
loc callGraphExcl = |file:///home/sander/Dropbox/Afstuderen%20UvA/graphs/untitled/src/verwerkt/markitup/callmap.json|;

printStatistics(pesMark.calls, callGraphIncl);
printStatistics(optMark, callGraphIncl);

pesMarkString = convertVertexGraphToStringGraph(pesMark.calls);
dynMar = convertJsonToGraph(callGraphIncl);
possibleIncorrectMark = generatePossibleIncorrectCallbackEdges(markLijstje);
----
IDENTIFIED FALSE POSITIVES:
dynMar - (dynMar - possibleIncorrectMark)
bugged = {
  <"Callee(jquery.markitup.js@152:7147-7607)","Func(jquery.markitup.js@152:7189-7606)">, //correct: function expr
  //<"Callee(jquery-1.6.2.js@908:41521-41556)","Func(jquery-1.6.2.js@819:37989-39786)">, //false positive, ref to jquery via property
  <"Callee(jquery-1.6.2.js@2350:100925-101055)","Func(jquery-1.6.2.js@2353:100971-101054)">, //correct, function expr
  //<"Callee(jquery.markitup.js@480:21874-21943)","Func(jquery-1.6.2.js@3729:162647-163664)">, //false positive, ref to jquery function via property
  <"Callee(jquery.markitup.js@144:6744-7116)","Func(jquery.markitup.js@144:6786-7115)">, //correct, function expr
  //<"Callee(jquery-1.6.2.js@115:6585-6603)","Func(jquery-1.6.2.js@535:25543-26578)">, //false positive, ref to jquery via property
  //<"Callee(jquery-1.6.2.js@4611:200273-200301)","Func(jquery-1.6.2.js@4638:201300-201854)">, //false positive, ref to jquery via property
  <"Callee(jquery-1.6.2.js@2936:129304-129356)","Func(jquery-1.6.2.js@2931:129005-129085)">, //correct, reference to function via name
  <"Callee(jquery-1.6.2.js@563:26915-26953)","Func(jquery-1.6.2.js@4208:182770-183380)"> //??
  };
  
  bugged = {
  <"Callee(jquery.markitup.js@152:7147-7607)","Func(jquery.markitup.js@152:7189-7606)">,
  <"Callee(jquery-1.6.2.js@2350:100925-101055)","Func(jquery-1.6.2.js@2353:100971-101054)">,
  <"Callee(jquery.markitup.js@144:6744-7116)","Func(jquery.markitup.js@144:6786-7115)">,
  <"Callee(jquery-1.6.2.js@2936:129304-129356)","Func(jquery-1.6.2.js@2931:129005-129085)">,
  <"Callee(jquery-1.6.2.js@563:26915-26953)","Func(jquery-1.6.2.js@4208:182770-183380)">
  };
----

optMarkString = convertVertexGraphToStringGraph(optMark);